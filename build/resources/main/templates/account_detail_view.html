<html>
    <head>
        <link rel="stylesheet" th:href="@{/css/all_pages.css}">
        <link rel="stylesheet" th:href="@{/css/account_detail_view.css}">
        <script th:src="@{/js/account_detail_view.js}"></script>
    </head>
    <body>
        <div class="table-block" th:each="accountEntry : ${accountDetailView.accountDetailBlocks}">
            <table>
                <thead>
                    <tr>
                        <th colspan="6" class="header-label" th:text="${accountEntry.key.accountName}"></th>
                    </tr>
                    <tr>
                        <th colspan="6" class="header-date" th:text="${accountDetailView.dateString}"></th>
                    </tr>
                    <tr>
                        <th>Trans #</th>
                        <th>Description</th>
                        <th>Approved</th>
                        <th>Post Date</th>
                        <th>Debit</th>
                        <th>Credit</th>
                    </tr>
                </thead>
                <tbody>
                    <th:block th:each="yearEntry : ${accountEntry.value}">
                        <tr class="year-block" th:attr="data-year=${yearEntry.key}">
                            <td colspan="6" class="year-header" th:text="${yearEntry.key}"></td>
                        </tr>
                        <th:block th:each="monthEntry : ${yearEntry.value.monthBlocks}">
                            <tr class="month-block" th:attr="data-year=${yearEntry.key},data-month=${monthEntry.key}">
                                <td colspan="6" class="month-header" th:text="${monthEntry.key}"></td>
                            </tr>
                            <tr class="entry-line" th:each="entryLine : ${monthEntry.value.accountDetailLines}" th:attr="data-entry-id=${entryLine.journalEntryID},data-year=${yearEntry.key},data-month=${monthEntry.key}">
                                <td><a th:text="${entryLine.journalEntryID}" href="http://localhost:8080/general_ledger"></a></td>
                                <td th:text="${entryLine.description}"></td>
                                <td th:if="${entryLine.postSignature} != null" th:text="${entryLine.postSignature}"></td>
                                <td th:unless="${entryLine.postSignature} != null">Error</td>
                                <td th:text="${entryLine.postDate}"></td>
                                <td th:if="${entryLine.type} == 'D'" th:text="${entryLine.amount}" class="debit-amount"></td>
                                <td th:unless="${entryLine.type} != 'D'"></td>
                                <td th:if="${entryLine.type} == 'C'" th:text="${entryLine.amount}" class="credit-amount"></td>
                                <td th:unless="${entryLine.type} != 'C'"></td>
                            </tr>
                            <tr class="mtd-totals-line" th:attr="data-year=${yearEntry.key},data-month=${monthEntry.key}">
                                <td colspan="3"></td>
                                <td>Totals:</td>
                                <td class="total month-total-debit" th:text="${monthEntry.value.totalDebits}">Err</td>
                                <td class="total month-total-credit" th:text="${monthEntry.value.totalCredits}">Err</td>
                            </tr>
                            <tr class="mtd-totals-line" th:attr="data-year=${yearEntry.key},data-month=${monthEntry.key}">
                                <td colspan="4"></td>
                                <td class="grand-total month-grand-total" th:if="${monthEntry.value.grandTotalType} == 'D'" th:text="${monthEntry.value.grandTotal}" th:attr="data-type='debit'"></td>
                                <td class="grand-total month-grand-total" th:unless="${monthEntry.value.grandTotalType} == 'D'"></td>
                                <td class="grand-total month-grand-total" th:if="${monthEntry.value.grandTotalType} == 'C'" th:text="${monthEntry.value.grandTotal}" th:attr="data-type='credit'"></td>
                                <td class="grand-total month-grand-total" th:unless="${monthEntry.value.grandTotalType} == 'C'"></td>
                            </tr>
                        </th:block>
                        <tr class="ytd-totals-line" th:attr="data-year=${yearEntry.key}">
                            <td colspan="3"></td>
                            <td>YTD:</td>
                            <td class="total year-total-debit" th:text="${yearEntry.value.totalDebits}">Err</td>
                            <td class="total year-total-credit" th:text="${yearEntry.value.totalCredits}">Err</td>
                        </tr>
                        <tr class="ytd-totals-line" th:attr="data-year=${yearEntry.key}">
                            <td colspan="4"></td>
                            <td class="grand-total year-grand-total" th:if="${yearEntry.value.grandTotalType} == 'D'" th:text="${yearEntry.value.grandTotal}" th:attr="data-type='debit'"></td>
                            <td class="grand-total year-grand-total" th:unless="${yearEntry.value.grandTotalType} == 'D'"></td>
                            <td class="grand-total year-grand-total" th:if="${yearEntry.value.grandTotalType} == 'C'" th:text="${yearEntry.value.grandTotal}" th:attr="data-type='credit'"></td>
                            <td class="grand-total year-grand-total" th:unless="${yearEntry.value.grandTotalType} == 'C'"></td>
                        </tr>
                    </th:block>
                    <tr class="grand-total-line" data-level="account">
                        <td colspan="3"></td>
                        <td>Report Total:</td>
                        <td class="total account-total-debit" th:text="${accountDetailView.totalDebits}">Err</td>
                        <td class="total account-total-credit" th:text="${accountDetailView.totalCredits}">Err</td>
                    </tr>
                    <tr class="grand-total-line" data-level="account">
                        <td colspan="4"></td>
                        <td class="grand-total account-grand-total" th:if="${accountDetailView.grandTotalType} == 'D'" th:text="${accountDetailView.grandTotal}" data-type="debit"></td>
                        <td class="grand-total account-grand-total" th:unless="${accountDetailView.grandTotalType} == 'D'"></td>
                        <td class="grand-total account-grand-total" th:if="${accountDetailView.grandTotalType} == 'C'" th:text="${accountDetailView.grandTotal}" data-type="credit"></td>
                        <td class="grand-total account-grand-total" th:unless="${accountDetailView.grandTotalType} == 'C'"></td>
                    </tr>
                </tbody>
            </table>
        </div>
    </body>
</html>